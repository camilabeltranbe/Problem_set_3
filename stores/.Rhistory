#####Datos - problem set 3######
rm(list = ls())
#install.packages("pacman")
require(pacman)
# Cargar las librerías listadas e instalarlas en caso de ser necesario
p_load(tidyverse, # Manipular dataframes
rio, # Import data easily
plotly, # Gráficos interactivos
leaflet, # Mapas interactivos
tmaptools, # geocode_OSM()
sf, # Leer/escribir/manipular datos espaciales
osmdata, # Get OSM's data
tidymodels,#para modelos de ML
visdat,#gráfica para missings
ggplot2,
stargazer,
modeest)
wd <- ("C:/Users/Juan/Documents/Problem_set_3")
#se define la ruta
setwd(paste0(wd,"/stores"))
# se cargan las bases de datos -------------------------------------------------
train <- read.csv("train.csv")
test <- read.csv("test.csv")
#dimensiones
dim(train) #386644 obs y 16 variables
dim(test) #10286 y 16 variables (var de precio está en NA)
#variables
colnames(train)
colnames(test)
# missing values ---------------------------------------------------------------
vis_dat(train)
vis_dat(test)
train <- train %>%
group_by(property_type) %>%
mutate(rooms2 = ifelse(is.na(rooms), mlv(rooms,na.rm = T), rooms),
bathrooms2 = ifelse(is.na(bathrooms), mlv(rooms,na.rm = T), bathrooms), #moda de cuartos
surface_total2 = ifelse(is.na(surface_total), mean(surface_total,na.rm = T), surface_total), #media de superficie total
surface_covered2 = ifelse(is.na(surface_covered), mean(surface_covered,na.rm = T), surface_covered)) #media de superficie cubierta
mlv(rooms,na.rm = T)
mlv(train$rooms,na.rm = T)
test <- test %>%
group_by(property_type) %>%
mutate(rooms2 = ifelse(is.na(rooms), mlv(rooms,na.rm = T), rooms),
bathrooms2 = ifelse(is.na(bathrooms), mlv(rooms,na.rm = T), bathrooms), #moda de cuartos
surface_total2 = ifelse(is.na(surface_total), mean(surface_total,na.rm = T), surface_total), #media de superficie total
surface_covered2 = ifelse(is.na(surface_covered), mean(surface_covered,na.rm = T), surface_covered)) #media de superficie cubierta
train <- as.data.frame(train)
test <- as.data.frame(test)
# creación, modificación de variables ------------------------------------------
## Transformacion Log(Precio)
train$Log_Precio <- log(train$price)
train <- train %>%
mutate(precio_mt2 = round(price/surface_total2,0))%>%
mutate(precio_mt2 = precio_mt2/1000000)  # precio x Mt2 en millones
summary(train$precio_mt2)
# estadísticas descriptivas ----------------------------------------------------
stargazer(train,type="text")
stargazer(test,type="text")
# estadísticas descriptivas ----------------------------------------------------
stargazer(train)
hist(train$price, probability = TRUE)
abline(v = mean(train$price), col='red', lwd = 3)
lines(density(train$price), col = 'green', lwd = 3)
hist((train$price/1000000), probability = TRUE)
abline(v = mean((train$price/1000000)), col='red', lwd = 3)
lines(density((train$price/1000000)), col = 'green', lwd = 3)
hist((train$price/1000000), probability = TRUE, col = 'blue', border = "white")
abline(v = mean((train$price/1000000)), col='red', lwd = 3)
lines(density((train$price/1000000)), col = 'green', lwd = 3)
hist((train$price/1000000), probability = TRUE, col = 'cadetblue4', border = "white")
abline(v = mean((train$price/1000000)), col='red', lwd = 3)
lines(density((train$price/1000000)), col = 'green', lwd = 3)
hist((train$price/1000000), probability = TRUE, col = 'cadetblue4', border = "white")
abline(v = mean((train$price/1000000)), col='red', lwd = 3)
lines(density((train$price/1000000)), col = 'cornsilk', lwd = 3)
hist((train$price/1000000), probability = TRUE, col = 'cadetblue4', border = "white")
abline(v = mean((train$price/1000000)), col='red', lwd = 3)
lines(density((train$price/1000000)), col = 'cadetblue1', lwd = 3)
hist((train$price/1000000), probability = TRUE, col = 'cadetblue4', border = "white", breaks = 100)
abline(v = mean((train$price/1000000)), col='red', lwd = 3)
lines(density((train$price/1000000)), col = 'cadetblue1', lwd = 3)
hist((train$price/1000000), probability = TRUE, col = 'cadetblue4', border = "white", breaks = 50)
abline(v = mean((train$price/1000000)), col='red', lwd = 3)
lines(density((train$price/1000000)), col = 'cadetblue1', lwd = 3)
hist((train$price/1000000), probability = TRUE, col = 'cadetblue4', border = "white", breaks = 30)
abline(v = mean((train$price/1000000)), col='red', lwd = 3)
lines(density((train$price/1000000)), col = 'cadetblue1', lwd = 3)
hist((train$price/1000000), probability = TRUE, col = 'cadetblue4', border = "white", breaks = 25)
abline(v = mean((train$price/1000000)), col='red', lwd = 3)
lines(density((train$price/1000000)), col = 'cadetblue1', lwd = 3)
ggplot(train, aes(x = (price/1000000), fill = rooms)) +
geom_histogram(color = '#e9ecef', alpha = 0.6, position = 'identity') +
labs(title = 'Histogramas Múltiples', x = 'Precio de Viviendas')
